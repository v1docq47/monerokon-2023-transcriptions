# Amir Taaki

_**Anonymous Set Proofs for Infinite Ring Size**_

[https://youtu.be/c936RGM1w5s](https://youtu.be/c936RGM1w5s)

---

_**Amir:**_ I will go into a bit of conceptual stuff about why this is needed, what's happening, and then I will go more into the thing. The core of the talk is about a particular technique that allows us to speed up the ring sizes in Monero. This is more of a theory talk. But there is a very good practical talk that was made by kayabaNerv, by Luke Parker, where he implemented, did really good job implementing a lot of this stuff. I recommend people to see that speak and also to look at his code that he just published.

So right now we are in a particular situation in crypto where the originally in 2012 a lot of us thought that the agris promise of crypto was an inevitability. And you know, laissez faire, it will get made and things will just happen. And here in 2023, and we still haven't realized that the core vision of what crypto is really about. And that's why I'm here in this conference with the ethos that the Monero community embody. We're in a very special time because as well, post-FTX, people are looking like: "Oh, where did everything go so wrong?" Now we're in that part of the cycle where people are seeking narratives that will form the basis of the next cycle. I saw some shills trying to go: "It will be TradFi, ha-ha". Yeah, good luck.

So, yeah, what we foresee happening is that, you know, there is a side of crypto that is fragile, you know, it's all these pumpy projects where, you know, they play this game and they create these big bloated teams and their business model is to like gather as many plebs and tax all those plebs, versus true crypto, which is the kind of DarkFi side of crypto, which is anti-fragile crypto. And anti-fragile crypto - the more the government cracks down, the state cracks down on it, the more stronger it becomes. Whereas fragile crypto breaks under pressure. And right now, we're seeing the government start to crack down on crypto, and we're seeing the increasing divergence of these two spheres, which will end in an end point where there will be a RegFi and there will be a DarkFi. So, DarkFi, we also have a project called DarkFi. And also, not only are we in that phase of crypto's lifecycle, where there's a return back to values, where people want to rediscover that which was lost, that gave us power.

Also, now we're in a cryptography renaissance. The cryptography that people are creating, which is driven by cryptocurrency or the investment into cryptography research has really borne some powerful techniques. And these techniques are coming into the hands of developers. And we can use those techniques to hack and to construct anonymous applications. We can use, if you look up cryptography on Wikipedia, sorry, no, if you look up hard power on Wikipedia, it defines hard power as military and economic power. But I think cryptography is a third new category. And we can use these cryptography techniques to enlarge the space of freedom. That's what agorism is. Agorism is using free markets to enlarge the space of freedom.

So also, sorry, let me just see. Oh my, so yeah, I don't have a slide for this. I should have, I forgot to put it. But now there is a window that's opening up. And the question is: can we be ready for that window to take charge of it? Because if we can, and we can solve the Achilles' heel in Monero, then privacy can come as a narrative to the forefront and uplift all of this side of crypto, agro side of crypto.

So, and also, this new cryptography paradigm that's happening now, it's a new field of anonymous engineering. A lot of the techniques we use, the basis is algebraic, it's not like old paradigms. So that's like a, you know, I don't wanna get too much into the evolution of ZK techniques and how it's going into modularity, et cetera.

I mean, ZK is one technique that's very important in this whole cryptography space. And right now what we're seeing is increasing specialization. So the future of cryptography looks like modular cryptography. There will be lots of different modules that you combine together, et cetera.

And so one thing I'm gonna talk about is set proofs. And set proofs is... In Monero, you have this ring. And okay, now there's a proposal that we can replace this ring using curve trees. And in curve trees, and so this is why I wanna illustrate in this talk about this specialization that's happening, is you need to have a very fast elliptic curve in a product proof. So one way that we can do that the normal classical ways – you build a circuit with those calculations, but right now all of the cryptography we use just uses very simple results from polynomial rings and elliptic curves, but there is a vast expanse out there of what's possible. There's a paper by Liam Egan where he talks about elliptic curve in a product proof using the Vi reciprocity rule. And so that's very interesting because that's an indication of how we can start constructing new forms of cryptography or new forms of proving systems, et cetera, using these higher geometrical or mathematical properties.

So, so in mathematics, a very important question in algebraic number theory is, okay, can we find prime numbers that are the sum of two squares? And one way to do that is you take the field of equations, which is basically all of the fractions where you have two integers, and you adjoin this square root of one, of minus one, sorry, which is i. And from that, you construct a field. And so then you can start using the machinery of algebra to start analyzing that field and going: okay, I want to find prime numbers, p, which are the factor of two prime elements in this field. So then, for example, we can start to go, we can start to look at this field and we can start to go: okay, what properties does this field have? You know, does it have, so like for example, when you have a number like alpha and you divide that number by another number, like for example, if I have like 10 divided by 3, then I will get 3.3333 and if I take the integer which is closest to 3 and I minus it from that then I get 0.33 which is less than 1. So always when you divide one number by another number if you take the closest integer to it then you get a remainder which is less than 1 and that property is called a Euclidean property. Euclidean domain.

So our first question is, is this field Q(i) Euclidean domain? As you can see that formalization for Euclidean domain on the bottom where it goes alpha is equal to some k multiplied by a quotient plus a remainder. And this remainder has to be less than the quotient. That's another way of formalizing what I just said before. So for example if I show a… So for example, in this book, we can look at page 126. OK, let's zoom in. So you see, we just took that formula there, and we just divide it by beta, and we rearrange it. And you get this formula at the bottom here. Where's my mouse? I guess I have my mouse. Oh, yeah. You see you get this one here. And so, you know, I said before you divide 10 by 3 and you find the nearest integer and you deduct it and then you get a number here. This norm of this is less than one.

So why am I interested in this particular property of Euclidean domain on this field? Well, it turns out that if it's a Euclidean domain, then it also has unique factorization. And why do we want unique factorization? It's because we want to look at this field Q(i), we want to find primes that are the product of two primes. So we want to be able to, we want to say: okay, this is a factorization that is unique of this field. And so solving this problem of finding two numbers that sum when they square to a prime, there's a very elegant proof of finding those, but it relies on this particular property of unique factorization.

So we already now found another property that implies unique factorization, which is Euclidean domains. But now our question is, and so for example, so for example here, we have - there might be other such fields that we look at - so here we have square root of minus three. If I zoom in. So where's my mouse? Here. So this is a lattice. And I can actually show. So, where is it? Actually. Well, actually… anyway, this is the lattice. And so all of the points in this space, those points, are points that are in that field of Q adjoined square root of minus 3. And so then we can say, we can divide up this space, and you say: okay, all of the points, do all of the points have a norm which is less than 1? So is there distance to a point in this lattice always less than 1? And so you can see that you can divide up the lattice into all these equal sections. You see this little hexagon in the middle. So then whatever I deduced about that hexagon is automatically true for the entire space. And so if I go here, for example, you can see that the norm is 0.5. So this is indeed a Euclidean domain. But you see, I can increase it. So for example, I increase to 11. And it's still a Euclidean domain. If I zoom in, I go just up here. Suddenly, you see it's 1.01. So square root of minus 15 stops being a Euclidean domain. And you can see here, it says only these fields are Euclidean, minus 2, minus 3, minus 7, minus 11.

So now our question becomes: okay, are there other unique factorization domains? Because, okay, we proved that these are unique factorization domains, but are there others which aren't Euclidean, but have that unique factorization property?

And so that's when we start to create this construct called a class group. And so the class group is then we go: okay, so, okay, now we're going to look at this in terms of ideals. We are going to take all of the group of ideals and we're going to quotient them by the group of principle ideals. So basically, if you have two ideals from this group, then the ideals are equivalent if this, if you have, if, if when you move the b to the other side, you have ab minus one, that there is some element that is in the principal group.

And so what this tells us then is, so okay, if we look, if, basically, so we had this on the previous thing, and one way of looking at that product is as a product of ideals. And so we can take any element in that field, we can reduce it to these objects, which are ideals, and then we go: okay, if this ideal can be represented by one object, then it actually represents an element in the field. So that's why we're looking at principle ideals, is because we're only interested in the ideals that represent a single object. So then our question goes: okay, how much does this entire field do deviate from being principal. And so that's why we construct that group thing there, because if the entire thing is principal, then the size of the group would just be one. There'll be only an identity element, because all the elements are the same as the principal elements. And if none of the elements are principal, then the size of that group will be the same as the size of the ideal group. So this actually gives us a measure how much does this ideal group deviate from being principle? And we use that as a measure of that. And so there's a lot of very interesting cryptography that people use using this, which is like ideal class groups.

Okay, is that maybe too small? Okay, so then to do computations, just as an aside on this ideal class group, we use something called quadratic forms. And it's very interesting because there's actually an isomorphism from the ideal to the class group. And you can also see the other way around. This is the quadratic form. And then this forms the ideal and ideal class group. And also, there is these forms, so you basically have, so you can basically show the form which is like x squared plus bxy plus cy squared with some additional restrictions under action by this matrix group SL2 is equivalent to ideal class groups. So you can take this thing which is an ideal class group, which is very abstract. There is an isomorphism to this thing called a binary quadratic form. And then you can do explicit computations on them.

And the interesting thing about the forms is there is an algorithm that if I give you a form of any of these cosets of the ideal class group. I could generate this one randomly. There's an algorithm that you run, which is this algorithm, that you run it. You will end up with a single representative of this coset. The representative will be reduced and you can show that there's always a bound, like it's below a certain bound. So that's why it becomes practical to do computation on quadratic forms.

So you can't see there, but there's... So the way that we can move between items within this coset is using this special matrix group called SL2. So all of the forms which share the same discriminant, which is on the right, they're within the same coset. So you see there's a form on the right, 7 minus 10, 4. And I can apply different values. And it's like a little game that I can do to try and reduce that. So let's see if I can do that. I have to make reduction, you know, when I'm sitting by myself I reduced it once. There's a way to... I reduced it and that's the final reduced form 1, 0, minus 3. You see I applied this and that's how the final matrix, which is as you see at the top T2 S T, and the top right is the actual matrix that you apply to the original form, and you get this final form within the coset.

So, okay, moving on. So then that same concept of the ideal class group, because people doing algebraic geometry, people doing algebraic number theory, a lot of it's very similar. So people go: oh, that's a good idea in algebraic geometry. You can use that to do number theory calculations, and then vice versa in algebraic geometry. So it's a lot of the same machinery and concepts transfer over. And so then people bring this idea to elliptic curves where they start going: okay, so there is this object in elliptic curve called a divisor. And what we're interested in, we're interested in functions over a function field. And we go: okay, there is some curve that we have like an elliptic curve. And we're interested in this function, this other function as well. But we're not interested in the function itself. We're interested in the function restricted to the elliptic curve. So the zeros where the function intersects the elliptic curve. And so then we can actually represent those functions using this object called divisors. And then we say that, you know, there are, and so one of the properties of a divisor is that always the degree and the sum are zero. And then we can construct this class groups for elliptic curves where we take the divisors, all the divisors that are possible, and we caution it out by the divisors that are principal. So you can see it's very similar to the class group here. It's nice for elliptic curves, and you see the multiplicative notation has changed the additive. We say the two divisors are equivalent if their difference is part of this principal group. So this is a generalization of that concept.

And so then inside of this divisor group, now it has its own properties and we study those, and mainly people use this for pairings. There's a lot of very interesting uses of this. So for example, this proof elliptic curve in a product argument, one of the properties of the divisor group is that it has this Vi reciprocity rule, which is the rule at the top, which is when you take f of the divisor of g and you evaluate a g of the divisor of f, they're both equivalent to each other. And that's due to the algebraic structure, which inside of algebraic geometry, they have something called the resultant. And the resultant is used to find when you have two functions in a function field, you use it to find, do these functions have a common factor? Or are these functions co-prime to each other? What it means co-prime, it means they don't have a common factor. So there are some quotients you can find for f and g, like a, f plus b, g, such that they're equal to one. This means because they're not in an ideal of that group. Anyway, you can, so this Vi reciprocity rule, which is defined over these abstract divisors, you can actually define it, you can define it very computationally using resultants. So, resultants, you can see, we've got P1 up to Pm, which are the zeros of g, and we've got P1, sorry, we've got Q1 up to Qn, which are the zeros of f. So, we have this reciprocity between these two things.

So, then in this proof, I have a divisor and I want to prove that this divisor is a principal divisor. So we had this class group before here, and I was like: okay, I've got an element of this group, but I want to prove actually this element is in the zero of this group. So one way that you can do it is you know that if there's a divisor that's principal, then it will obey this reciprocity rule.

So the way it's constructed is that he have, there is a line, which is a challenge point, which is a challenge to the protocol by the verifier. And you have your curve, which you have a function, and you have a certain set of zeros, and you're trying to prove those zeros are the zeros of that function. So then you can evaluate the verifier's line against your points, which is your points at Q, and his line is g. And you can do the same for f, which is your curve, and the points of the line, which is going to be three points. Because elliptic curve and a line intersecting three points by Bezout's theorem.

And so, yes, so then we have now this statement at the bottom, which is multiplicative. But actually, we can do another speed up, which is we can turn this multiplicative statement into an additive statement. Then we have this very nice function, which is called a discrete log. And so the discrete log is defined as above at the top, which is you take the derivative of u and you divide it by u. So we can actually see that if we have the D(u ˖ v), then if we put it here on the right, we apply the same rule above. We get the derivative of uv divided by uv. And then if we expand that out using the, I think it's the chain rule, then you can see we get u′v over plus v′u divided by uv. And if you split those two on the left and the right, then you get u′v. You get, sorry, u′ divided by u plus v′ divided by v, which you see at the top is equal to D(u) plus D(v). So we turned a multiplicative statement, which is uv, into this other statement, which is uv. And so then the proof operate on top of the discrete log.

And so then this approach to do is very interesting and we can actually do more stuff with this. So that entire machinery, we could use it to construct proofs of statements about divisor class groups. So for example, now I'm very interested in hyper-elliptic divisors because hyper-elliptic curves of genus 3. They have unknown order. And so then you can start using also the group order as a trapdoor function as well. And you can do interesting things with that. And also, yeah, unknown order groups. And then also now there's been a very interesting trend of creating additional operators inside of ZK-proving machinery.

And then also in general, where a lot of this is going is, because it's still very new, nascent paradigm. And I see a lot of people creating ZK languages where there's like a Turing complete or like superficially like smart contracts style language to write circuits, but the paradigm is very different. So the tooling that we're gonna create is still very nascent. But also like a lot of the tuning of circuits is done by hand. So for example, if I do elliptic curve multiplication, and I use a lookup table, there's like a fixed size lookup table I add to the circuit. And it automatically pushes my circuit to a certain size. And you have all these gadgets that you put onto the circuit. But they're all predefined size. And there's not really right now tool chains which are taking those statements and be able to convert them into algebraic ones and optimize them. So we're still very early with all of this stuff. It's really untapped and unexplored space.

So Monero, why can't, like what's stopping it being the store of value? It would just, if we fixed the ring size, then there's no reason for Bitcoin, it would literally be Monero. So that's why we need to fix that. And now we have this new cryptography, very powerful techniques, which developers can wield. And that has opened up a new design space. And our thesis that we published two years ago, you can search RektNews, Lunapunk, you know, it's a five minute video, you should watch that video, it's from two years ago. Literally, we released it, and then the Tornado Cash got taken down. And at this point, we published that two years ago. This point is practically inevitable. The DarkFi side, the agorist side of crypto is going to rally. We need to mobilize as a movement. We need to move towards our objectives. So Satoshi, he said: "We can win a major battle in the arms race and gain a new territory of freedom for several years". So thanks.
